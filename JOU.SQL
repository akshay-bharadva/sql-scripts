/*
CREATE AN ORDER_MASTER DATABASE AND ALSO CREATE THE FOLLOWING
TABLES WITH APPROPRIATE CONSTRAINTS AND INPUT AT LEAST 20 RECORDS
IN ORDER_MASTER TABLE, 05 RECORDS IN PRODUCT_MASTER TABLE,
AND 10 RECORDS IN  SALESMAN_MASTER TABLE.
*/

CREATE TABLE ORDER_MASTER
(
	ORDER_NO INTEGER PRIMARY KEY,
	PROD_NO INTEGER,
	QTY INTEGER,
	DISCOUNT INTEGER,
	ORDER_DATE DATE,
	GST INTEGER,
	PAYMENT_TYPE VARCHAR(50),
	TOTAL_AMOUNT INTEGER
);

CREATE TABLE PRODUCT_MASTER
(
	PRODUCT_NO INTEGER PRIMARY KEY,
	PRODUCT_NAME VARCHAR(50),
	DESCRIPTION VARCHAR(50),
	QUANTITY INTEGER,
	SELL_PRICE INTEGER,
	COST_PRICE FLOAT
);

CREATE TABLE SALESMAN_MASTER
(
	SALESMAN_NO INTEGER PRIMARY KEY,
	SALESMAN_NAME VARCHAR(50),
	CITY VARCHAR(50),
	PINCODE INTEGER,
	STATE VARCHAR(50),
	SALARY INTEGER,
	REMARKS VARCHAR(50),
	ORDER_NO INTEGER,
	FOREIGN KEY(ORDER_NO) REFERENCES ORDER_MASTER(ORDER_NO)
);

ALTER TABLE ORDER_MASTER
ADD CONSTRAINT FK FOREIGN KEY(PROD_NO)
REFERENCES PRODUCT_MASTER(PRODUCT_NO);

INSERT INTO PRODUCT_MASTER
VALUES (2101,'MONITOR','FULL HD+ DISPLAY',15,1500,1000);
INSERT INTO PRODUCT_MASTER
VALUES (3201,'CPU','WITH 8GB RAM & 256GB SSD',10,9600,8000);
INSERT INTO PRODUCT_MASTER
VALUES (4301,'ABCD','UPTO "Z" ALPHABETS',100,500,450);
INSERT INTO PRODUCT_MASTER
VALUES (5401,'KEYBOARD','WITH INBUILT SCROLLING',25,950,790);
INSERT INTO PRODUCT_MASTER
VALUES (6501,'MOUSE','WITH EXTRA GAMING BUTTONS',25,650,500);

INSERT INTO SALESMAN_MASTER 
VALUES(1024,'AKSHAY','SURAT',394210,'GUJARAT',12560,'VERY LAZY PERSON',1209);
INSERT INTO SALESMAN_MASTER 
VALUES(2024,'DIPIKA','MUMBAI',395050,'MAHARASHTRA',15000,'VERY TALL PERSON',1210);
INSERT INTO SALESMAN_MASTER 
VALUES(3024,'CHIRAG','NAVSARI',399305,'GUJARAT',10000,'VERY THIN PERSON',1211);
INSERT INTO SALESMAN_MASTER 
VALUES(4024,'MIHIR','SURAT',394220,'GUJARAT',2500,'VERY LONGLIVING PERSON',1212);
INSERT INTO SALESMAN_MASTER 
VALUES(5024,'VENKY','MUMBAI',405010,'MAHARASHTRA',9500,'CHILDLIKE PERSON',1213);
INSERT INTO SALESMAN_MASTER 
VALUES(6024,'BHAVIN','KERLA',505109,'KERLA',16350,'ACTIVE PERSON',1214);
INSERT INTO SALESMAN_MASTER 
VALUES(7024,'RAVI','SURAT',390081,'GUJARAT',1530,'VERY FAT PERSON',1215);
INSERT INTO SALESMAN_MASTER 
VALUES(8024,'DIVYANG','JAIPUR',415263,'RAJASTHAN',1250,'VERY FUNNY PERSON',1216);
INSERT INTO SALESMAN_MASTER 
VALUES(9024,'JAYAN','SHIRDI',395052,'MAHARASHTRA',1100,'VERY ROMANTIC PERSON',1217);
INSERT INTO SALESMAN_MASTER 
VALUES(10024,'MIRAL','KARNATKA',665934,'KARNATKA',4500,'VERY STYLISH PERSON',1218);


INSERT INTO ORDER_MASTER
VALUES (1209,3201,2,5,'2018-05-23',3,'GOOGLE PAY',19200);
INSERT INTO ORDER_MASTER
VALUES (1210,4301,1,4,'2019-06-30',2,'UPI',500);
INSERT INTO ORDER_MASTER
VALUES (1211,2101,1,2,'2020-07-02',3,'PAYTM',1500);
INSERT INTO ORDER_MASTER
VALUES (1212,5401,3,4,'2019-11-21',5,'PAYPAL',2850);
INSERT INTO ORDER_MASTER
VALUES (1213,2101,2,5,'2019-12-25',3,'AMAZON PAY',3000);
INSERT INTO ORDER_MASTER
VALUES (1214,3201,2,6,'2019-01-09',0,'PHONE PAY',19200);
INSERT INTO ORDER_MASTER
VALUES (1215,2101,1,2,'2019-02-28',3,'AIRTEL BANK',1500);
INSERT INTO ORDER_MASTER
VALUES (1216,5401,5,4,'2019-06-18',2,'GOOGLE PAY',4750);
INSERT INTO ORDER_MASTER
VALUES (1217,3201,1,7,'2019-05-01',3,'UPI',9600);
INSERT INTO ORDER_MASTER
VALUES (1218,4301,2,9,'2019-03-26',1,'GOOGLE PAY',1000);
INSERT INTO ORDER_MASTER
VALUES (1219,5401,1,10,'2019-09-28',1,'UPI',950);
INSERT INTO ORDER_MASTER
VALUES (1220,6501,1,5,'2019-10-30',5,'PAYTM',650);
INSERT INTO ORDER_MASTER
VALUES (1221,4301,3,6,'2019-12-12',2,'AMAZON PAY',1500);
INSERT INTO ORDER_MASTER
VALUES (1222,3201,5,4,'2019-11-10',10,'GOOGLE PAY',48000);
INSERT INTO ORDER_MASTER
VALUES (1223,2101,1,9,'2018-08-07',1,'UPI',1500);
INSERT INTO ORDER_MASTER
VALUES (1224,4301,1,7,'2019-07-23',3,'PAYTM',500);
INSERT INTO ORDER_MASTER
VALUES (1225,6501,2,2,'2019-06-08',2,'GOOGLE PAY',1300);
INSERT INTO ORDER_MASTER
VALUES (1226,4301,2,5,'2019-04-22',5,'AIRTEL BANK',1000);
INSERT INTO ORDER_MASTER
VALUES (1227,2101,3,4,'2019-02-17',2,'AMAZON PAY',4500);
INSERT INTO ORDER_MASTER
VALUES (1228,3201,1,3,'2020-01-24',0,'PHONE PAY',9600);

/*1.	DISPLAY ALL THE ORDER WITH PAYMENT_TYPE ‘UPI’.*/
SELECT * FROM ORDER_MASTER WHERE PAYMENT_TYPE LIKE 'UPI';

/*2.	DISPLAY ALL SALESMAN NAME FROM SALESMAN_MASTER TABLE.*/
SELECT SALESMAN_NAME FROM SALESMAN_MASTER;

/*3.	RETRIEVE THE LIST OF NAME AND CITY OF ALL THE SALESMEN.*/
SELECT SALESMAN_NAME,CITY FROM SALESMAN_MASTER;

/*4.	LIST THE VARIOUS PRODUCTS AVAILABLE IN PRODUCT_MASTER TABLE.*/
SELECT DISTINCT PRODUCT_NAME FROM PRODUCT_MASTER;

/*5.	LIST ALL THE SALESMEN WHO ARE LOCATED IN MUMBAI.*/
SELECT * FROM SALESMAN_MASTER WHERE CITY LIKE 'MUMBAI';

/*6.	LIST ALL THE PRODUCTS WHOSE SELL_PRICE IS >= 1000 RUPEES.*/
SELECT * FROM PRODUCT_MASTER WHERE SELL_PRICE >=1000;

/*7.	CHANGE THE CITY OF SALESMAN ‘AKSHAY’ TO ‘UNJHA’ IN SALESMAN_MASTER TABLE.*/
UPDATE SALESMAN_MASTER SET CITY = 'UNJHA' WHERE SALESMAN_NAME LIKE 'AKSHAY';

/*8.	CHANGE THE COST_PRICE OF MONITOR TO 999.50 RUPEES.*/
UPDATE PRODUCT_MASTER SET COST_PRICE = 999.50 WHERE PRODUCT_NAME LIKE 'MONITOR';

/*9.	CHANGE THE SALARY OF ‘DIPIKA’ TO 6500 RUPEES.*/
UPDATE SALESMAN_MASTER SET SALARY = 6500 WHERE SALESMAN_NAME LIKE 'DIPIKA';

/*10.	DELETE ALL SALESMAN FROM SALESMAN_MASTER WHOSE SALARIES ARE GREATER THAN 5000RS.*/
DELETE FROM SALESMAN_MASTER WHERE SALARY >5000;

/*11.	DELETE ALL PRODUCTS FROM PRODUCT_MASTER WHERE THE QUANTITY IS EQUAL TO 100.*/
DELETE FROM PRODUCT_MASTER WHERE QUANTITY = 100;

/*12.	DELETE FROM ORDER_MASTER WHERE ORDER DURATION MORE THAN 6 MONTHS.*/
DELETE FROM ORDER_MASTER WHERE DATEDIFF('MM',ORDER_DATE,CURRENT_DATE) > 6;

/*13.	ADD A COLUMN CALLED ‘TELEPHONE’ OF DATA TYPE NUMBER AND SIZE 10 TO THE SALESMAN_MASTER TABLE.*/
ALTER TABLE SALESMAN_MASTER ADD COLUMN 'TELEPHONE' INTEGER(10);

/*14.	CHANGE THE SIZE OF SELL_PRICE COLUMN IN PRODUCT_MASTER TO (10,2).*/
ALTER TABLE PRODUCT_MASTER ALTER COLUMN SELL_PRICE NUMERIC(10,2);

/*15.	COUNT THE TOTAL NUMBER OF SALESMEN WORKING IN SURAT CITY.*/
SELECT * FROM SALESMAN_MASTER WHERE CITY LIKE 'SURAT';

/*16.	DISPLAY THE NAME OF THE PRODUCT WHOSE ORDER PLACED MAXIMUM TIME.*/
SELECT PRODUCT_NAME FROM PRODUCT_MASTER,
    (SELECT PROD_NO AS MAXPRODN FROM 
        (SELECT COUNT(*) AS PRODC,PROD_NO FROM ORDER_MASTER GROUP BY PROD_NO),
        (SELECT MAX(ALLPRODC) AS MAXPRODC FROM (SELECT COUNT(*) AS ALLPRODC,PROD_NO FROM ORDER_MASTER GROUP BY PROD_NO)) WHERE PRODC = MAXPRODC
    )WHERE PRODUCT_NO = MAXPRODN;
/*SELECT PRODUCT_NAME FROM PRODUCT_MASTER WHERE PRODUCT_NO IN
	( SELECT PROD_NO FROM ORDER_MASTER GROUP BY PROD_NO HAVING COUNT(*) = 
	 	(SELECT COUNT(*) FROM ORDER_MASTER GROUP BY PROD_NO ORDER BY COUNT(*) DESC LIMIT 1)
	);
*//*WORK IN MYSQL && TRIED AT NJ WITH JAYAN*/

/*17.	DESTROY THE TABLE ORDER_MASTER ALONG WITH ITS DATA.*/
DROP TABLE ORDER_MASTER;

/*18.	DISPLAY TOTAL GST COLLECTED ON CURRENT DATE.*/
SELECT SUM(GST) FROM ORDER_MASTER  WHERE ORDER_DATE = CURRENT_DATE;

/*19.	DISPLAY ALL PRODUCTS WHOSE NAME ARE FOUR CHARACTERS LONG AND STARTS WITH ‘A’.*/
SELECT PRODUCT_NAME FROM PRODUCT_MASTER WHERE PRODUCT_NAME LIKE 'A___'

/*20.	INCREASE THE PRICE OF PRODUCTS BY 5% WHICH HAS HIGHEST DISCOUNT.*/
UPDATE PRODUCT_MASTER SET SELL_PRICE = SELL_PRICE + SELL_PRICE*0.05 WHERE PRODUCT_NO = 
    (SELECT PROD_NO FROM ORDER_MASTER WHERE DISCOUNT =
        (SELECT MAX(DISCOUNT) FROM ORDER_MASTER
        )
    );
/*UPDATE ORDER_MASTER SET TOTAL_AMOUNT = TOTAL_AMOUNT + ( TOTAL_AMOUNT * 0.05 ) 
WHERE DISCOUNT =( SELECT MAX(DISCOUNT) FROM ORDER_MASTER );
*//*WORK IN MYSQL && TRIED AT NJ WITH JAYAN*/


/*21.	DISPLAY ALL THE PRODUCTS SOLD TODAY.*/
SELECT PRODUCT_NAME FROM PRODUCT_MASTER WHERE PRODUCT_NO = 
	(SELECT PROD_NO FROM ORDER_MASTER WHERE ORDER_DATE = CURRENT_DATE);

/*22.	DISPLAY TOTAL STOCK OF ALL THE PRODUCT.*/
SELECT SUM(QUANTITY) AS TOTAL_STOCK FROM PRODUCT_MASTER;

/*23.	UPDATE GST FOR ALL ORDERS TO 7%.*/
UPDATE ORDER_MASTER SET GST = 7;
